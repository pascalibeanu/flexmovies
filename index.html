<html><head><base href="https://bit.ly/Flexmovies">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FlexMovies - Streaming and Download Movies and TV Shows for free</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Poppins:wght@600&display=swap" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    :root {
      --primary-color: #e50914;
      --background-color: #141414;
      --secondary-color: #232323;
      --text-color: #fff;
      --hover-color: rgba(255, 255, 255, 0.1);
      --fs-base: clamp(1rem, 0.8vw + 0.9rem, 1.2rem);
      --fs-h1: clamp(2rem, 4vw + 1rem, 3.5rem);
      --fs-h2: clamp(1.5rem, 3vw + 0.9rem, 2.5rem);
    }
    * {
    text-align: left;
    }

    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background-color: var(--background-color);
      color: var(--text-color);
    }
    .container {
      width: min(90%, 1200px);
      margin-inline: auto;
      padding: max(2vw, 20px);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 0; 
    }
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background-color: transparent;
      background-image: linear-gradient(to bottom, rgba(0,0,0,0.9), transparent);
      z-index: 100;
      padding: clamp(8px, 2vw, 20px);
      height: clamp(50px, 8vh, 70px);
      display: flex;
      align-items: center;
      justify-content: center; 
      gap: 20px; 
      transition: all 0.3s ease;
    }
    header.scrolled {
      background-color: rgba(20, 20, 20, 0.98);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    .header-top {
      position: absolute; 
      left: 20px; 
      display: flex;
      align-items: center;
      margin: 0;
      padding: 0;
      width: auto;
      justify-content: center;
    }
    /* Logo Container Styles */
.logo-container {
  position: sticky; /* Positions it relative to the top-left corner */
  top: 0;
  left: 0;
  padding: 1px; /* Adds spacing from the edges */
  z-index: 1000; /* Ensures the logo is always on top */
  display: flex;
  align-items: self-start;
  justify-content: center;
  height: 70px;
  width: auto;
}

/* Responsive Adjustments */
.logo {
  height: 60px; /* Adjusts size to fit smaller screens */
  width: auto;
  transition: transform 0.3s ease-in-out, filter 0.3s ease-in-out;
}

.logo-container:hover .logo {
  transform: scale(1.1); /* Interactive scaling effect */
  filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.7));
}

/* Additional Responsiveness for Small Devices */
@media (max-width: 768px) {
  .logo {
    height: 50px; /* Smaller size for tablets */
  }

  .logo-container {
    padding: 8px;
  }
}

@media (max-width: 480px) {
  .logo {
    height: 40px; /* Even smaller size for mobile devices */
  }

  .logo-container {
    padding: 20px;
  }
}

    h1 {
      color: var(--primary-color);
      margin: 0;
      display: none;
    }
    .search-container {
      width: min(100%, 500px);
      margin: 0 auto; 
      display: flex;
      gap: clamp(5px, 1vw, 10px);
      justify-content: center;
    }
    #searchInput {
      padding: 8px 15px; 
      font-size: 1rem; 
      border-radius: 5px;
      background-color: rgba(0,0,0,0.75);
      color: var(--text-color);
      border: 1px solid rgba(255,255,255,0.2);
      transition: all 0.3s ease;
      flex-grow: 1;
    }
    #searchInput:focus {
      background-color: rgba(0,0,0,0.9);
      border-color: var(--primary-color);
      outline: none;
    }
    #searchButton {
      padding: 8px 20px; 
      font-size: 1rem; 
      background-color: var(--primary-color);
      color: var(--text-color);
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      font-weight: 600;
    }
    #searchButton:hover {
      background-color: #f40612;
    }
    .media-section {
      margin-bottom: 40px;
      width: 100%; 
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(min(140px, 100%), 1fr));
      gap: clamp(10px, 2vw, 25px);
      padding: 20px 0;
      width: 100%;
    }
    .media-item {
      position: relative;
      overflow: hidden;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      transition: transform 0.2s ease, box-shadow 0.2s ease; 
      cursor: pointer;
      aspect-ratio: 2/3;
    }
    .media-item:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }
    .media-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 5px; 
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .media-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(20, 20, 20, 0.8); 
      padding: 20px;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .media-item:hover .media-info {
      transform: translateY(0);
    }
    .media-title {
      margin: 0;
      font-size: 1rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .media-rating {
      font-size: 0.9rem;
      color: #ffd700;
      margin: 5px 0;
    }
    .media-details {
      font-size: 0.8rem;
      margin: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
    }
    .modal-content {
      background-color: rgba(20, 20, 20, 0.98);
      backdrop-filter: blur(15px);
      margin: 3% auto;
      padding: clamp(15px, 3vw, 30px);
      border: none;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.6);
      width: min(95%, 1000px);
      color: var(--text-color);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: center;
    }
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }
    .close:hover,
    .close:focus {
      color: var(--text-color);
      text-decoration: none;
      cursor: pointer;
    }
    #mediaInfo {
      margin-top: 20px;
      padding: 20px;
      background-color: #333;
      border-radius: 5px;
    }
    footer {
      text-align: center;
      padding: 20px 0;
      color: var(--text-color);
      font-size: 14px;
      font-weight: bold;
    }
    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      width: 100%;
      margin-bottom: 20px;
    }
    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
    .sidebar {
      position: fixed;
      left: -100%;
      top: 0;
      height: 100%;
      width: 250px;
      background-color: rgba(20, 20, 20, 0.98);
      backdrop-filter: blur(10px);
      transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 2;
      padding-top: 80px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.3);
      text-align: center;
    }
    .sidebar.open {
      left: 0;
    }
    .sidebar-toggle {
      position: fixed;
      left: 20px;
      top: 60px; 
      z-index: 101;
      background: var(--primary-color);
      border: none;
      color: var(--text-color);
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 70px;
    }
    .genre-list {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: calc(100vh - 80px);
      overflow-y: auto;
      scrollbar-width: thin;
    }
    .genre-list::-webkit-scrollbar {
      width: 8px;
    }
    .genre-list::-webkit-scrollbar-track {
      background: transparent;
    }
    .genre-list::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.2);
      border-radius: 4px;
      transition: background 0.3s ease;
    }
    .genre-list::-webkit-scrollbar-thumb:hover {
      background: rgba(255,255,255,0.3);
    }
    .genre-item {
      padding: 15px 24px;
      cursor: pointer;
      transition: background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-size: 1rem;
    }
    .genre-item:hover {
      background-color: var(--hover-color);
    }
    .genre-header {
      background-color: var(--secondary-color);
      font-size: 0.9rem;
      letter-spacing: 2px;
      padding: 20px;
      font-weight: bold;
      color: var(--primary-color);
      text-transform: uppercase;
    }
    #seasonSelect, #episodeSelect {
      padding: 12px 20px;
      margin: 10px;
      min-width: 200px;
      background-color: rgba(0,0,0,0.8);
      color: var(--text-color);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 4px;
    }
    #seasonSelect option, #episodeSelect option {
      padding: 8px;
      background-color: rgba(0,0,0,0.8);
      color: var(--text-color);
    }
    #seasonEpisodeSelector {
      margin: 25px 0;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: center;
    }
    #seasonEpisodeSelector button {
      padding: 12px 24px;
      background-color: var(--primary-color);
      color: var(--text-color);
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #seasonEpisodeSelector button:hover {
      background-color: #f40612;
    }
    .button-group {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      justify-content: center;
      flex-wrap: wrap;
      width: 100%;
    }

    .button-group button {
      padding: 12px 24px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      background: rgba(229, 9, 20, 0.9);
      backdrop-filter: blur(5px);
      color: var(--text-color);
      flex: 1;
      min-width: 200px;
      max-width: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .button-group button:hover {
      background: rgba(229, 9, 20, 1);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .download-btn {
      background-color: #2ecc71 !important;
    }

    .download-btn:hover {
      background-color: #27ae60 !important;
    }

    .trailer-buttons-container {
      display: flex;
      flex-direction: column;
      width: 100%;
      gap: 20px;
      margin: 20px 0;
      justify-content: center;
    }

    .video-container {
      width: 100%;
      margin-bottom: 20px;
    }

    .similar-media {
      margin-top: 30px;
    }

    .similar-media h3 {
      margin-bottom: 15px;
      color: var(--text-color);
    }

    .similar-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
    }

    @media (max-width: 768px) {
      .similar-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
    }
    .cast-section {
      margin: 20px 0;
      text-align: center;
    }

    .cast-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .cast-item {
      text-align: center;
    }

    .cast-photo {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 8px;
    }

    .cast-name {
      font-size: 0.9rem;
      margin: 0;
      color: var(--text-color);
    }

    .cast-character {
      font-size: 0.8rem;
      margin: 0;
      color: #999;
    }
    @media (max-width: 768px) {
      header {
        flex-direction: column; 
        align-items: flex-start; 
        padding: 16px; 
      }
      
      .header-top {
        margin-bottom: 10px; 
      }

      .search-container {
        width: 100%; 
        flex-direction: row; 
        justify-content: space-between; 
        margin: 10px 0; 
      }

      #searchInput {
        width: calc(100% - 120px); 
      }

      .location-select {
        width: auto; 
        flex: 1 1 100px; 
        margin-right: 5px; 
      }

      .location-select {
        flex: 0 0 100px; 
        min-width: 100px; 
      }
      
      #searchInput {
        width: calc(100% - 120px); 
      }
      
      .location-select {
        width: 90px;
        font-size: 0.85rem;
      }

      #searchButton {
        padding: 8px 12px;
        white-space: nowrap;
        min-width: 60px;
      }
      
      .header-top {
        flex: 0 0 auto;
      }

      
    }
    @media (max-width: 480px) {
      .search-container {
        padding: 0 10px;
      }
      
      #searchInput {
        width: calc(100% - 120px);
      }
      
      .location-select {
        width: 90px;
        font-size: 0.85rem;
      }

      #searchButton {
        padding: 8px 10px;
        font-size: 0.85rem;
        min-width: 68px;
      }
    }
    .banner {
      width: 100%;
      height: clamp(400px, 85vh, 800px);
      position: relative;
      overflow: hidden;
      margin-bottom: 40px;
      box-shadow: 0 4px 30px rgba(0,0,0,0.3);
      text-align: center;
    }

    .banner-slide {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1);
      background-size: cover;
      background-position: center;
      display: flex;
      align-items: flex-end;
      padding: 60px;
      background-image: 
        linear-gradient(to right, rgba(0,0,0,0.9) 15%, rgba(0,0,0,0.4) 50%, transparent),
        linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.4) 50%, transparent),
        var(--bg-image);
    }

    .banner-slide.active {
      opacity: 1;
    }

    .banner-content {
      max-width: min(90%, 650px);
      color: var(--text-color);
      position: relative; 
      z-index: 2;
      padding: clamp(20px, 4vw, 40px);
      margin: clamp(20px, 4vw, 60px);
      background: none;
      backdrop-filter: none;
      border-radius: 12px;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.6s ease;
      opacity: 0;
      transform: translateY(30px);
      border: none;
      pointer-events: none;
    }

    .banner-slide.active .banner-content {
      opacity: 1;
      transform: translateY(0);
    }

    .banner::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 250px;
      background: linear-gradient(transparent, rgba(20, 20, 20, 0.9) 70%, var(--background-color));
    }

    .banner-title {
      font-size: var(--fs-h1);
      margin-bottom: 20px;
      font-weight: 800;
      text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
      background: linear-gradient(45deg, #ffffff, #ffffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.5px;
      line-height: 1.1;
    }

    .banner-overview {
      font-size: var(--fs-base);
      margin-bottom: 35px;
      line-height: 1.5;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.9);
      color: rgba(255, 255, 255, 0.95);
      max-width: 90%;
    }

    .banner-button {
      padding: 16px 36px;
      background: var(--primary-color);
      color: var(--text-color);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1.2rem;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 4px 15px rgba(229, 9, 20, 0.4);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 10px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
      pointer-events: auto;
    }

    .banner-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(229, 9, 20, 0.6);
      background: #f40612;
    }

    .banner-button svg {
      width: 24px;
      height: 24px;
      margin-right: 4px;
    }

    @media (max-width: 768px) {
      .banner {
        height: 70vh;
      }
      
      .banner-slide {
        padding: 30px;
      }
      
      .banner-content {
        margin-left: 20px;
        margin-bottom: 40px;
        padding: 30px;
      }
      
      .banner-title {
        font-size: 2.2rem;
      }
      
      .banner-overview {
        font-size: 1rem;
        -webkit-line-clamp: 3;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
      
      .banner-button {
        padding: 14px 28px;
        font-size: 1rem;
      }
    }

    @media (max-width: 480px) {
      .banner {
        height: 60vh;
      }
      
      .banner-slide {
        padding: 20px;
      }
      
      .banner-title {
        font-size: 1.8rem;
      }
      
      .banner-content {
        margin-left: 10px;
        margin-bottom: 30px;
        padding: 20px;
      }
      
      .banner-button {
        padding: 12px 24px;
        font-size: 0.9rem;
      }
    }
    .location-select {
      padding: 8px 15px;
      font-size: 1rem;
      border-radius: 5px;
      background-color: rgba(0,0,0,0.75);
      color: var(--text-color);
      border: 1px solid rgba(255,255,255,0.2);
      transition: all 0.3s ease;
      margin: 0 auto;
      width: fit-content;
      cursor: pointer;
    }

    .location-select:focus {
      background-color: rgba(0,0,0,0.9);
      border-color: var(--primary-color);
      outline: none;
    }

    @media (max-width: 768px) {
      .location-select {
        flex: 0 0 100px; 
        min-width: 100px; 
      }
      
      #searchInput {
        width: calc(100% - 120px); 
      }
    }
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }
    .warning-message {
      background-color: #e50914; 
      color: #fff; 
      text-align: center;
      padding: 10px;
      font-size: 1.2rem; 
      margin-top: 10px; 
      position: absolute; 
      bottom: 0; 
      width: 100%; 
      z-index: 10; 
    }
    .note-message {
    color: red;
    text-align: center;
    font-size: 1rem;
    margin: 20px 0;
}

  </style>
</head>
<body><center>
          <button class="sidebar-toggle">&#x2630; Categories</button>
      </center>
  
  <div class="sidebar">
    <ul class="genre-list" id="genreList"></ul>
  </div>
  <div class="banner" id="banner">
    <!-- Banner slides will be inserted here by JavaScript -->
    <div class="note-message">
      Note: You will be redirected once or twice just come back, and after that, it will deactivate.
  </div>
  
    
      
    </div>
  </div>
  <div class="container">
    <header>
      
      <div class="logo-container">
        <svg class="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 150" fill="none">
          <!-- Gradient Definitions -->
          <defs>
            <linearGradient id="mainGradient" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#ff8a00">
                <animate attributeName="stop-color" values="#ff8a00; #e50914; #6a0dad; #ff8a00" dur="4s" repeatCount="indefinite" />
              </stop>
              <stop offset="100%" stop-color="#e50914">
                <animate attributeName="stop-color" values="#e50914; #6a0dad; #ff8a00; #e50914" dur="4s" repeatCount="indefinite" />
              </stop>
            </linearGradient>
          </defs>
      
          <!-- Background Animation (Circle Orbit) -->
          <circle cx="250" cy="75" r="65" stroke="url(#mainGradient)" stroke-width="5" fill="none">
            <animateTransform attributeName="transform" type="rotate" from="0 250 75" to="360 250 75" dur="6s" repeatCount="indefinite" />
          </circle>
      
          <!-- Logo Text -->
          <text x="130" y="90" font-family="'Poppins', sans-serif" font-size="60" font-weight="bold" fill="url(#mainGradient)" letter-spacing="2">
            Flex
          </text>
          <text x="270" y="90" font-family="'Poppins', sans-serif" font-size="60" font-weight="lighter" fill="white" letter-spacing="1">
            Movies
          </text>
        </svg>
      </div>
      
      
      
      <div class="search-container">
        <select id="locationSelect" class="location-select">
          <option value="global">Global</option>
          <option value="NG">Nigeria</option>
          <option value="US">United States</option>
          <option value="GB">United Kingdom</option>
          <option value="IN">India</option>
          <option value="KR">South Korea</option>
          <option value="JP">Japan</option>
          <option value="FR">France</option>
          <option value="DE">Germany</option>
          <option value="ES">Spain</option>
          <option value="IT">Italy</option>
          <option value="BR">Brazil</option>
          <option value="MX">Mexico</option>
          <option value="CA">Canada</option>
          <option value="AU">Australia</option>
          <option value="ZA">South Africa</option>
        </select>
        <input type="text" id="searchInput" placeholder="Search for movies or TV shows...">
        <button id="searchButton">Search</button>
      </div>
    </header>

    <section class="media-section">
      <div id="mediaGrid" class="media-grid"></div>
    </section>
  </div>

  <div id="playerModal" class="modal">
    <div class="modal-content">
      <span class="close">&#xd7;</span>
      <div class="video-container">
        <iframe id="player" frameborder="0" allowfullscreen></iframe>
      </div>
      <div id="mediaInfo"></div>
    </div>
  </div>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="64" height="64">
    <defs>
      <linearGradient id="pulseGradient" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="#e50914">
          <animate attributeName="stop-color" values="#e50914; #ff8a00; #6a0dad; #e50914" dur="4s" repeatCount="indefinite" />
        </stop>
        <stop offset="100%" stop-color="#6a0dad">
          <animate attributeName="stop-color" values="#6a0dad; #e50914; #ff8a00; #6a0dad" dur="4s" repeatCount="indefinite" />
        </stop>
      </linearGradient>
    </defs>
    <circle cx="32" cy="32" r="28" fill="url(#pulseGradient)">
      <animate attributeName="r" values="28;32;28" dur="2s" repeatCount="indefinite" />
    </circle>
    <text x="32" y="38" font-family="Poppins, sans-serif" font-size="24" fill="#fff" text-anchor="middle" font-weight="bold">
      FM
    </text>
  </svg>
  

  <script>const CONFIG = {
  apiKeys: {
    tmdb: '45a766dcce0da3d639845fd158b346e6'
  },
  urls: {
    tmdb: {
      base: 'https://api.themoviedb.org/3',
      images: 'https://image.tmdb.org/t/p/w500'
    },
    videoServers: {
      server1: {
        base: 'https://vidsrc.vip/embed',
        moviePath: '/movie/',
        tvPath: '/tv/'
      },
      server2: {
        base: 'https://vidsrc.icu/embed',
        moviePath: '/movie/',
        tvPath: '/tv/'
      }
    }
  },
  defaultLanguage: 'en-US',
  gridSettings: {
    mobileBreakpoint: 768,
    defaultPageSize: 20
  },
  styling: {
    colors: {
      primary: '#e50914',
      background: '#141414',
      secondary: '#232323',
      text: '#fff'
    }
  },
  ui: {
    breakpoints: {
      mobile: 480,
      tablet: 768,
      desktop: 1024
    },
    animation: {
      duration: 300,
      easing: 'ease'
    }
  }
};
let currentMediaType = 'movie';
let currentPage = 1;
let isLoading = false;
let displayedMediaIds = new Set();
let isSearchMode = false;
let currentGenreId = null;
let currentGenreType = null;
let currentBannerSlide = 0;
let bannerSlides = [];
let currentLocation = 'global';
const selectLocationElement = document.getElementById('locationSelect');
const sidebarToggle = document.querySelector('.sidebar-toggle');
function updateCSSVariables() {
  const root = document.documentElement;
  root.style.setProperty('--primary-color', CONFIG.styling.colors.primary);
  root.style.setProperty('--background-color', CONFIG.styling.colors.background);
  root.style.setProperty('--secondary-color', CONFIG.styling.colors.secondary);
  root.style.setProperty('--text-color', CONFIG.styling.colors.text);
  root.style.setProperty('--mobile-breakpoint', `${CONFIG.gridSettings.mobileBreakpoint}px`);
}
async function fetchTMDBData(endpoint, params = {}) {
  try {
    const url = new URL(`${CONFIG.urls.tmdb.base}${endpoint}`);
    url.searchParams.append('api_key', CONFIG.apiKeys.tmdb);
    url.searchParams.append('language', CONFIG.defaultLanguage);
    url.searchParams.append('certification_country', 'US');
    url.searchParams.append('certification.lte', 'PG-13');
    url.searchParams.append('include_adult', 'false');
    Object.keys(params).forEach(key => url.searchParams.append(key, params[key]));
    const response = await fetch(url);
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    return await response.json();
  } catch (error) {
    console.error('Error fetching TMDB data:', error);
    return null;
  }
}
async function fetchTrendingMedia() {
  return await fetchTMDBData('/trending/all/week', {
    include_adult: false,
    'certification.lte': 'PG-13',
    certification_country: 'US'
  });
}
async function loadPopularMedia() {
  if (isLoading || isSearchMode) return;
  isLoading = true;
  try {
    let mediaData;
    if (currentLocation === 'global') {
      mediaData = await fetchTMDBData(`/${currentMediaType}/popular`, {
        page: currentPage
      });
    } else {
      mediaData = await fetchRegionalContent(currentLocation, currentPage);
    }
    if (mediaData) {
      displayMedia(mediaData.results, 'mediaGrid', currentMediaType, currentPage === 1);
      currentPage++;
    }
  } catch (error) {
    console.error(`Error loading media:`, error);
  } finally {
    isLoading = false;
  }
}
function displayMedia(mediaList, containerId, mediaType, clearContainer = false) {
  const container = document.getElementById(containerId);
  if (clearContainer) {
    container.innerHTML = '';
    displayedMediaIds.clear();
  }
  const itemCount = container.querySelectorAll('.media-item').length;
  mediaList.forEach((item, index) => {
    if (!displayedMediaIds.has(item.id)) {
      displayedMediaIds.add(item.id);
      const mediaItem = document.createElement('a');
      mediaItem.href = 'https://www.profitablecpmrate.com/s7x44fuhcs?key=0c96b412da7670ee6533b8ca77b9f2ab';
      mediaItem.target = '_blank';
      mediaItem.className = 'media-item';
      mediaItem.innerHTML = `
                <img src="${CONFIG.urls.tmdb.images}${item.poster_path}" alt="${item.title || item.name}">
                <div class="media-info">
                  <h3 class="media-title">${item.title || item.name}</h3>
                  <p class="media-rating">
                    ${item.vote_average ? '⭐ ' + item.vote_average.toFixed(1) : ''}
                  </p>
                </div>
              `;
      mediaItem.style.animation = `fadeIn ${0.3 + index * 0.1}s cubic-bezier(0.4, 0, 0.2, 1)`;
      mediaItem.addEventListener('click', event => {
        setTimeout(() => {
          mediaItem.href = '';
        }, 500);
        openMediaDetails(item.id, item.media_type || (mediaType === 'multi' ? item.title ? 'movie' : 'tv' : mediaType));
      });
      container.appendChild(mediaItem);
    }
  });
}
async function openMediaDetails(id, mediaType) {
  const type = mediaType || 'movie';
  try {
    const [mediaDetails, trailerUrl, similarMedia, castDetails] = await Promise.all([fetchTMDBData(`/${type}/${id}`), fetchTrailer(type, id), fetchSimilarMedia(type, id), fetchCastDetails(type, id)]);
    if (!mediaDetails) return;
    const modalContent = document.querySelector('.modal-content');
    const trailerContainer = trailerUrl ? `
              <div class="trailer-buttons-container">
                <div class="video-container">
                  <iframe 
                    src="${trailerUrl}" 
                    frameborder="0" 
                    allowfullscreen
                    allow="autoplay; encrypted-media; picture-in-picture"
                  ></iframe>
                </div>
                ${type === 'movie' ? `
                  <div class="button-group">
                    <button id="playMovieButtonServer1">▶ Play Movie (Server 1)</button>
                    <button id="playMovieButtonServer2">▶ Play Movie (Server 2)</button>
                    <button id="downloadMovieButton" class="download-btn">⬇ Download Movie</button>
                  </div>
                ` : `
                  <div id="seasonEpisodeSelector">
                    <div class="button-group">
                      <button id="playEpisodeButtonServer1">▶ Play Episode (Server 1)</button>
                      <button id="playEpisodeButtonServer2">▶ Play Episode (Server 2)</button>
                      <button id="downloadEpisodeButton" class="download-btn">⬇ Download Episode</button>
                    </div>
                  </div>
                `}
              </div>
            ` : '';
    modalContent.innerHTML = `
              <span class="close">&times;</span>
              <h2>${mediaDetails.title || mediaDetails.name}</h2>
              ${trailerContainer}
              <p>${mediaDetails.overview}</p>
              <p>Release Date: ${mediaDetails.release_date || mediaDetails.first_air_date}</p>
              <p>Rating: ${mediaDetails.vote_average}/10</p>
              <p>Category: ${mediaDetails.genres.map(genre => genre.name).join(', ')}</p>
              
              <div class="cast-section">
                <h3>Cast</h3>
                <div class="cast-grid">
                  ${castDetails.map(actor => `
                    <div class="cast-item">
                      <img 
                        class="cast-photo" 
                        src="${actor.profile_path ? CONFIG.urls.tmdb.images + actor.profile_path : 'https://via.placeholder.com/100x100'}" 
                        alt="${actor.name}"
                      >
                      <p class="cast-name">${actor.name}</p>
                      <p class="cast-character">${actor.character}</p>
                    </div>
                  `).join('')}
                </div>
              </div>
            `;
    if (type === 'movie') {
      const playMovieButtonServer1 = document.getElementById('playMovieButtonServer1');
      const playMovieButtonServer2 = document.getElementById('playMovieButtonServer2');
      const downloadMovieButton = document.getElementById('downloadMovieButton');
      playMovieButtonServer1.addEventListener('click', () => {
        const url = getVideoUrl('movie', mediaDetails).server1;
        loadVideo(url, mediaDetails);
      });
      playMovieButtonServer2.addEventListener('click', () => {
        const url = getVideoUrl('movie', mediaDetails).server2;
        loadVideo(url, mediaDetails);
      });
      downloadMovieButton.addEventListener('click', () => {
        const downloadUrl = `https://www.lulacloud.cfd/movie/${mediaDetails.title.toLowerCase().replace(/[^a-z0-9]+/g, '-')}`;
        window.open(downloadUrl, '_blank');
      });
    } else if (type === 'tv') {
      const playEpisodeButtonServer1 = document.getElementById('playEpisodeButtonServer1');
      const playEpisodeButtonServer2 = document.getElementById('playEpisodeButtonServer2');
      const downloadEpisodeButton = document.getElementById('downloadEpisodeButton');
      playEpisodeButtonServer1.addEventListener('click', () => {});
      playEpisodeButtonServer2.addEventListener('click', () => {});
      downloadEpisodeButton.addEventListener('click', () => {
        const downloadUrl = `https://www.lulacloud.cfd/movie/${mediaDetails.name.toLowerCase().replace(/[^a-z0-9]+/g, '-')}`;
        window.open(downloadUrl, '_blank');
      });
    }
    setupCloseButton();
    document.getElementById('playerModal').style.display = "block";
  } catch (error) {
    console.error('Error loading media details:', error);
  }
}
async function loadSeasonEpisodeSelector(tvShowId, seriesDetails) {
  const seasons = await fetchTMDBData(`/tv/${tvShowId}`);
  if (!seasons) return;
  const selectorContainer = document.getElementById('seasonEpisodeSelector');
  const seasonSelect = document.createElement('select');
  seasonSelect.id = 'seasonSelect';
  seasons.seasons.forEach(season => {
    const option = document.createElement('option');
    option.value = season.season_number;
    option.textContent = season.name || `Season ${season.season_number}`;
    seasonSelect.appendChild(option);
  });
  const episodeSelect = document.createElement('select');
  episodeSelect.id = 'episodeSelect';
  const playEpisodeButtonServer1 = document.createElement('button');
  playEpisodeButtonServer1.textContent = 'Play Episode (Server 1)';
  playEpisodeButtonServer1.id = 'playEpisodeButtonServer1';
  const playEpisodeButtonServer2 = document.createElement('button');
  playEpisodeButtonServer2.textContent = 'Play Episode (Server 2)';
  playEpisodeButtonServer2.id = 'playEpisodeButtonServer2';
  const downloadEpisodeButton = document.createElement('button');
  downloadEpisodeButton.textContent = 'Download Episode';
  downloadEpisodeButton.className = 'download-btn';
  downloadEpisodeButton.id = 'downloadEpisodeButton';
  selectorContainer.appendChild(seasonSelect);
  selectorContainer.appendChild(episodeSelect);
  selectorContainer.appendChild(playEpisodeButtonServer1);
  selectorContainer.appendChild(playEpisodeButtonServer2);
  selectorContainer.appendChild(downloadEpisodeButton);
  seasonSelect.addEventListener('change', async () => {
    const selectedSeason = seasonSelect.value;
    const episodes = await fetchTMDBData(`/tv/${tvShowId}/season/${selectedSeason}`);
    episodeSelect.innerHTML = '';
    episodes.episodes.forEach(episode => {
      const option = document.createElement('option');
      option.value = episode.episode_number;
      option.textContent = `${episode.episode_number}. ${episode.name || `Episode ${episode.episode_number}`}`;
      episodeSelect.appendChild(option);
    });
  });
  playEpisodeButtonServer1.addEventListener('click', () => {
    const selectedSeason = seasonSelect.value;
    const selectedEpisode = episodeSelect.value;
    const url = getVideoUrl('tv', seriesDetails, selectedSeason, selectedEpisode).server1;
    loadVideo(url, seriesDetails);
  });
  playEpisodeButtonServer2.addEventListener('click', () => {
    const selectedSeason = seasonSelect.value;
    const selectedEpisode = episodeSelect.value;
    const url = getVideoUrl('tv', seriesDetails, selectedSeason, selectedEpisode).server2;
    loadVideo(url, seriesDetails);
  });
  downloadEpisodeButton.addEventListener('click', () => {
    const selectedSeason = seasonSelect.value;
    const selectedEpisode = episodeSelect.value;
    const downloadUrl = getDownloadUrl('tv', seriesDetails, selectedSeason, selectedEpisode);
    window.open(downloadUrl, '_blank');
  });
  seasonSelect.dispatchEvent(new Event('change'));
}
function getVideoUrl(mediaType, mediaDetails, season = null, episode = null) {
  const servers = CONFIG.urls.videoServers;
  const getServer1Url = () => {
    if (mediaType === 'movie') {
      return `${servers.server1.base}${servers.server1.moviePath}${mediaDetails.id}`;
    } else {
      return `${servers.server1.base}${servers.server1.tvPath}${mediaDetails.id}-${season}-${episode}`;
    }
  };
  const getServer2Url = () => {
    if (mediaType === 'movie') {
      return `${servers.server2.base}${servers.server2.moviePath}${mediaDetails.id}`;
    } else {
      return `${servers.server2.base}${servers.server2.tvPath}${mediaDetails.id}/${season}/${episode}`;
    }
  };
  return {
    server1: getServer1Url(),
    server2: getServer2Url()
  };
}
function loadVideo(url, mediaDetails = null) {
  const modalContent = document.querySelector('.modal-content');
  modalContent.innerHTML = `
            <span class="close">&times;</span>
            <div class="video-container">
              <iframe 
                id="player" 
                src="${url}" 
                frameborder="0" 
                allowfullscreen
                allow="autoplay; encrypted-media; picture-in-picture"
              ></iframe>
            </div>
            <div class="note-message">
    Note: You will be redirected once or twice, just come back and after that, it will deactivate and the video will play.
</div>

            ${mediaDetails ? `
              <div class="media-details">
                <h2>${mediaDetails.title || mediaDetails.name}</h2>
                <p class="overview">${mediaDetails.overview}</p>
              </div>
            ` : ''}
          `;
  const container = document.querySelector('.video-container');
  if (container) {
    const aspectRatio = window.innerWidth <= 768 ? '16/9' : '21/9';
    container.style.aspectRatio = aspectRatio;
  }
  setupCloseButton();
}
function setupCloseButton() {
  const modal = document.getElementById('playerModal');
  const closeBtn = modal.querySelector('.close');
  function closeModal() {
    const videoContainer = modal.querySelector('.video-container');
    if (videoContainer) {
      const iframe = videoContainer.querySelector('iframe');
      if (iframe) {
        iframe.src = '';
      }
    }
    modal.style.display = "none";
    document.body.style.overflow = 'auto';
  }
  closeBtn.onclick = closeModal;
  window.onclick = function (event) {
    if (event.target == modal) {
      closeModal();
    }
  };
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape' && modal.style.display === 'block') {
      closeModal();
    }
  });
}
async function searchMedia(query) {
  let searchResults;
  if (currentLocation === 'global') {
    searchResults = await fetchTMDBData('/search/multi', {
      query: query,
      include_adult: false,
      'certification.lte': 'PG-13'
    });
  } else {
    searchResults = await fetchTMDBData('/search/movie', {
      query: query,
      with_origin_country: currentLocation,
      include_adult: false,
      'certification.lte': 'PG-13'
    });
  }
  const filteredResults = currentLocation === 'global' ? searchResults.results.filter(item => item.media_type === 'movie' || item.media_type === 'tv') : searchResults.results;
  displayMedia(filteredResults, 'mediaGrid', 'multi', true);
}
async function loadGenres() {
  try {
    const movieGenres = await fetchTMDBData('/genre/movie/list');
    const tvGenres = await fetchTMDBData('/genre/tv/list');
    const genreList = document.getElementById('genreList');
    genreList.innerHTML = `
                  <li class="genre-header">Movie Categories</li>
                  ${movieGenres.genres.map(genre => `<li class="genre-item" data-type="movie" data-id="${genre.id}">${genre.name}</li>`).join('')}
                  <li class="genre-header">TV Show Categories</li>
                  ${tvGenres.genres.map(genre => `<li class="genre-item" data-type="tv" data-id="${genre.id}">${genre.name}</li>`).join('')}
                `;
    genreList.querySelectorAll('.genre-item').forEach(item => {
      item.addEventListener('click', () => {
        loadGenreContent(item.dataset.id, item.dataset.type);
      });
    });
  } catch (error) {
    console.error('Error loading genres:', error);
  }
}
async function loadGenreContent(genreId, mediaType, clearContent = true) {
  isLoading = true;
  isSearchMode = true;
  if (clearContent) {
    currentPage = 1;
    currentGenreId = genreId;
    currentGenreType = mediaType;
  }
  try {
    const results = await fetchTMDBData(`/discover/${mediaType}`, {
      with_genres: genreId,
      page: currentPage,
      include_adult: false,
      'certification.lte': 'PG-13',
      certification_country: 'US'
    });
    displayMedia(results.results, 'mediaGrid', mediaType, clearContent);
    currentPage++;
  } catch (error) {
    console.error('Error loading genre content:', error);
  } finally {
    isLoading = false;
  }
}
async function fetchTrailer(mediaType, id) {
  try {
    const videos = await fetchTMDBData(`/${mediaType}/${id}/videos`);
    const trailer = videos.results.find(v => v.type === 'Trailer' && v.site === 'YouTube') || videos.results[0];
    return trailer ? `https://www.youtube.com/embed/${trailer.key}` : null;
  } catch (error) {
    console.error('Error fetching trailer:', error);
    return null;
  }
}
async function fetchSimilarMedia(mediaType, id) {
  try {
    const similar = await fetchTMDBData(`/${mediaType}/${id}/similar`);
    return similar.results.slice(0, 6);
  } catch (error) {
    console.error('Error fetching similar media:', error);
    return [];
  }
}
async function fetchCastDetails(mediaType, id) {
  try {
    const credits = await fetchTMDBData(`/${mediaType}/${id}/credits`);
    return credits.cast.slice(0, 8);
  } catch (error) {
    console.error('Error fetching cast details:', error);
    return [];
  }
}
async function fetchRegionalContent(region = 'global', page = 1) {
  try {
    let endpoint = '/discover/movie';
    let params = {
      page,
      sort_by: 'popularity.desc',
      include_adult: false,
      'certification.lte': 'PG-13',
      certification_country: 'US'
    };
    if (region !== 'global') {
      params.with_origin_country = region;
      switch (region) {
        case 'NG':
          params.with_original_language = 'en';
          break;
        case 'IN':
          params.with_original_language = 'hi|ta|te|ml|bn';
          break;
        case 'KR':
          params.with_original_language = 'ko';
          break;
        case 'JP':
          params.with_original_language = 'ja';
          break;
        case 'FR':
          params.with_original_language = 'fr';
          break;
        case 'DE':
          params.with_original_language = 'de';
          break;
        case 'ES':
          params.with_original_language = 'es';
          break;
        case 'IT':
          params.with_original_language = 'it';
          break;
        case 'BR':
          params.with_original_language = 'pt';
          break;
      }
    }
    const results = await fetchTMDBData(endpoint, params);
    return results;
  } catch (error) {
    console.error('Error fetching regional content:', error);
    return null;
  }
}
function updateDynamicLayout(width) {
  const isMobile = width <= 768;
  const isTablet = width <= 1024 && width > 768;
  const mediaGrid = document.querySelector('.media-grid');
  if (mediaGrid) {
    const columns = isMobile ? 2 : isTablet ? 3 : 'auto-fill';
    mediaGrid.style.gridTemplateColumns = `repeat(${columns}, minmax(${isMobile ? '140px' : '180px'}, 1fr))`;
  }
  const bannerTitle = document.querySelector('.banner-title');
  if (bannerTitle) {
    bannerTitle.style.fontSize = `clamp(${isMobile ? '1.8rem' : '2.5rem'}, ${isMobile ? '4vw' : '5vw'}, ${isMobile ? '2.5rem' : '3.5rem'})`;
  }
  const modalContent = document.querySelector('.modal-content');
  if (modalContent) {
    modalContent.style.margin = isMobile ? '0' : '3% auto';
    modalContent.style.width = isMobile ? '100%' : '90%';
    modalContent.style.borderRadius = isMobile ? '0' : '12px';
  }
  const searchContainer = document.querySelector('.search-container');
  if (searchContainer) {
    searchContainer.style.width = isMobile ? 'calc(100% - 30px)' : 'min(100%, 500px)';
  }
  const searchInput = document.querySelector('#searchInput');
  if (searchInput) {
    searchInput.style.width = isMobile ? 'calc(100% - 120px)' : 'auto';
  }
}
window.addEventListener('scroll', () => {
  requestAnimationFrame(updateDynamicLayout.bind(null, window.innerWidth));
}, {
  passive: true
});
window.addEventListener('orientationchange', () => {
  setTimeout(() => {
    updateDynamicLayout(window.innerWidth);
  }, 100);
});
window.addEventListener('resize', () => {
  const mediaGrid = document.getElementById('mediaGrid');
  if (mediaGrid) {
    const items = mediaGrid.querySelectorAll('.media-item');
  }
});
document.addEventListener('DOMContentLoaded', () => {
  updateCSSVariables();
  const resizeObserver = new ResizeObserver(entries => {
    for (let entry of entries) {
      updateDynamicLayout(entry.contentRect.width);
    }
  });
  resizeObserver.observe(document.body);
  const searchInput = document.getElementById('searchInput');
  const searchButton = document.getElementById('searchButton');
  loadPopularMedia();
  searchButton.addEventListener('click', () => {
    const query = searchInput.value.trim();
    if (query) {
      searchMedia(query);
    }
  });
  searchInput.addEventListener('keyup', event => {
    if (event.key === 'Enter') {
      const query = searchInput.value.trim();
      if (query) {
        searchMedia(query);
      }
    }
  });
  window.addEventListener('scroll', () => {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 500 && !isLoading) {
      if (currentGenreId !== null) {
        loadGenreContent(currentGenreId, currentGenreType, false);
      } else if (!isSearchMode) {
        loadPopularMedia();
      }
    }
  });
  const overlay = document.createElement('div');
  overlay.className = 'sidebar-overlay';
  document.body.appendChild(overlay);
  const sidebarToggle = document.querySelector('.sidebar-toggle');
  const sidebar = document.querySelector('.sidebar');
  sidebarToggle.addEventListener('click', () => {
    sidebar.classList.toggle('open');
    overlay.classList.toggle('active');
    document.body.style.overflow = sidebar.classList.contains('open') ? 'hidden' : '';
  });
  overlay.addEventListener('click', () => {
    sidebar.classList.remove('open');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  });
  let touchStartX = 0;
  let touchEndX = 0;
  sidebar.addEventListener('touchstart', e => {
    touchStartX = e.changedTouches[0].screenX;
  });
  sidebar.addEventListener('touchend', e => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
  });
  function handleSwipe() {
    const swipeThreshold = 100;
    if (touchEndX - touchStartX > swipeThreshold) {
      sidebar.classList.remove('open');
      overlay.classList.remove('active');
      document.body.style.overflow = '';
    }
  }
  document.addEventListener('click', e => {
    if (!sidebar.contains(e.target) && !sidebarToggle.contains(e.target)) {
      sidebar.classList.remove('open');
      overlay.classList.remove('active');
      document.body.style.overflow = '';
    }
  });
  window.addEventListener('orientationchange', () => {
    sidebar.classList.remove('open');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  });
  loadGenres();
  document.querySelector('.logo').addEventListener('click', () => {
    document.getElementById('searchInput').value = '';
    isSearchMode = false;
    currentPage = 1;
    currentGenreId = null;
    currentGenreType = null;
    document.getElementById('mediaGrid').innerHTML = '';
    displayedMediaIds.clear();
    loadPopularMedia();
  });
  setupCloseButton();
  async function initializeBanner() {
    const trendingMedia = await fetchTrendingMedia();
    bannerSlides = trendingMedia.results.slice(0, 5);
    const banner = document.getElementById('banner');
    banner.innerHTML = bannerSlides.map((media, index) => `
              <div class="banner-slide ${index === 0 ? 'active' : ''}" 
                   style="background-image: linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.2)), url('${CONFIG.urls.tmdb.images.replace('w500', 'original')}${media.backdrop_path}')">
                <div class="banner-content">
                  <h2 class="banner-title">${media.title || media.name}</h2>
                  <p class="banner-overview">${media.overview}</p>
                  <button class="banner-button" data-id="${media.id}" data-type="${media.media_type}">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                    Watch Now
                  </button>
                  <div class="note-message">
                    Note: You will be redirected once or twice, just come back and after that, it will deactivate.
                  </div>

                </div>
              </div>
            `).join('');
    banner.addEventListener('click', e => {
      const button = e.target.closest('.banner-button');
      if (button) {
        const id = button.dataset.id;
        const type = button.dataset.type;
        openMediaDetails(id, type);
      }
    });
    setInterval(rotateBanner, 6000);
  }
  document.documentElement.style.scrollBehavior = 'smooth';
  let lastScrollY = window.scrollY;
  window.addEventListener('scroll', () => {
    const header = document.querySelector('header');
    if (window.scrollY > lastScrollY) {
      header.style.transform = 'translateY(-100%)';
    } else {
      header.style.transform = 'translateY(0)';
    }
    if (window.scrollY > 50) {
      header.classList.add('scrolled');
    } else {
      header.classList.remove('scrolled');
    }
    lastScrollY = window.scrollY;
  });
  function rotateBanner() {
    const slides = document.querySelectorAll('.banner-slide');
    const currentSlide = slides[currentBannerSlide];
    const nextSlide = slides[(currentBannerSlide + 1) % slides.length];
    currentSlide.style.opacity = '0';
    setTimeout(() => {
      currentSlide.classList.remove('active');
      currentBannerSlide = (currentBannerSlide + 1) % slides.length;
      nextSlide.classList.add('active');
      setTimeout(() => {
        nextSlide.style.opacity = '1';
      }, 50);
    }, 600);
  }
  locationSelect = document.getElementById('locationSelect');
  locationSelect.addEventListener('change', async () => {
    currentLocation = locationSelect.value;
    currentPage = 1;
    isSearchMode = false;
    document.getElementById('mediaGrid').innerHTML = '';
    displayedMediaIds.clear();
    if (currentLocation === 'global') {
      loadPopularMedia();
    } else {
      const regionalContent = await fetchRegionalContent(currentLocation);
      if (regionalContent) {
        displayMedia(regionalContent.results, 'mediaGrid', 'movie', true);
      }
    }
  });
  initializeBanner();
  loadGenres();
});
document.addEventListener('DOMContentLoaded', () => {
  const modal = document.getElementById('playerModal');
  const sidebar = document.querySelector('.sidebar');
  const overlay = document.querySelector('.sidebar-overlay');

  function closeModal() {
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
  }

  function closeSidebar() {
    sidebar.classList.remove('open');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  }

  // Add history state when modal or sidebar is opened
  function pushStateForOverlay(type) {
    history.pushState({ type }, '', window.location.href);
  }

  // Handle back button press
  window.addEventListener('popstate', (event) => {
    if (event.state?.type === 'modal' && modal.style.display === 'block') {
      closeModal();
    } else if (event.state?.type === 'sidebar' && sidebar.classList.contains('open')) {
      closeSidebar();
    }
  });

  // Hook modal open actions
  modal.querySelector('.close').addEventListener('click', closeModal);
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && modal.style.display === 'block') closeModal();
  });

  // Hook sidebar open actions
  const sidebarToggle = document.querySelector('.sidebar-toggle');
  sidebarToggle.addEventListener('click', () => {
    if (!sidebar.classList.contains('open')) {
      sidebar.classList.add('open');
      overlay.classList.add('active');
      document.body.style.overflow = 'hidden';
      pushStateForOverlay('sidebar');
    }
  });

  // Ensure modals or sidebars are closed when overlay is clicked
  overlay.addEventListener('click', closeSidebar);

  // Example: Open modal and push state
  function openModal() {
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
    pushStateForOverlay('modal');
  }

  // Example function to test modal open
  document.getElementById('someButton').addEventListener('click', openModal); // Replace with your trigger
});

document.addEventListener("DOMContentLoaded", () => {
    const playerModal = document.getElementById('playerModal');
    const closeModalBtn = playerModal.querySelector('.close');
    const serverButtons = [
        document.getElementById('playMovieButtonServer1'),
        document.getElementById('playMovieButtonServer2')
    ];

    function enableLandscapeFullscreen() {
        if (screen.orientation && screen.orientation.lock) {
            screen.orientation.lock('landscape').catch(console.error);
        }
        if (playerModal.requestFullscreen) {
            playerModal.requestFullscreen().catch(console.error);
        } else if (playerModal.webkitRequestFullscreen) { // Safari
            playerModal.webkitRequestFullscreen();
        }
        document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function exitLandscapeFullscreen() {
        if (screen.orientation && screen.orientation.unlock) {
            screen.orientation.unlock();
        }
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.webkitExitFullscreen) { // Safari
            document.webkitExitFullscreen();
        }
        document.body.style.overflow = ''; // Re-enable background scrolling
    }

    function closeModal() {
        exitLandscapeFullscreen();
        playerModal.style.display = 'none';
    }

    // Attach event listeners to server buttons
    serverButtons.forEach(button => {
        if (button) {
            button.addEventListener('click', () => {
                enableLandscapeFullscreen();
                playerModal.style.display = 'block';
            });
        }
    });

    // Close modal on close button click
    closeModalBtn.addEventListener('click', closeModal);

    // Close modal on back button press
    window.addEventListener('popstate', () => {
        if (playerModal.style.display === 'block') {
            closeModal();
        }
    });

    // Add a history state to enable the back button to work
    playerModal.addEventListener('click', () => {
        history.pushState({}, '');
    });
});




</script>
</body>
</html>
